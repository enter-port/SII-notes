# 双曲型方程激波捕捉的机器学习算法

## 双曲型方程的特征线结构

考虑初值问题

$$
\begin{cases}
\rho_t + f^{'}(\rho)\rho_x=0,\ \ x \in \mathbb{R}, t > 0 \\
\rho(x, 0) = \rho_0(x),\ \ x\in \mathbb{R}
\end{cases}
$$

考虑特征线，即定义$(x(t), t)$满足

$$
\frac{dx(t)}{dt} = f^{'}(\rho(x(t), t))
$$

则方程的解沿特征线满足

$$
\frac{d\rho(x(t), t)}{dt} = \frac{\partial \rho}{\partial x} \frac{dx(t)}{dt} + \frac{\partial \rho}{\partial t} = f^{'}(\rho)\rho_x + \rho_t = 0
$$

即

- $\rho(x, t)$沿特征线$(x(t), t)$恒为常数
- $\frac{dx(t)}{dt} = \rho(x(t), t) = C$，即特征线为直线

## 1 数学模型

考虑任意封闭区域$D$（其边界为$\partial D$）上水流的变化，若记$t$时刻$x$位置处的水流密度$\rho(x, t)$，水流速度$u(x, t)$，则$t$时刻区域$D$内流体总量为

$$
\int_{D}\rho(x, t)dx
$$

### 1.1 交通流方程

假设车辆密度为$\rho(x, t)$，行驶速度为$u(x, t)$，由守恒律可得

$$
\frac{\partial}{\partial t}\rho + \frac{\partial}{\partial x}(\rho u) = 0
$$

我们建模车流密度和速度满足关系

$$
u(p) = u_{max}(1-\frac{\rho}{\rho_{max}})
$$

不妨设$u_{max} = 1, \rho_{max} = 1$，记$f(p)=p(1-p)$，便可得到LWR模型方程

$$
\rho_t + (f(p))_x = 0
$$

#### 1.1.1 交通堵塞

考虑初值

$$
\rho_0(x)=
\begin{cases}
0.5, & x<0 \\
1, & x\ge 0
\end{cases}
$$

由此可知，特征线的图像为

$$
f^{'}(\rho_0(x))=1 - 2\rho_0(x)=
\begin{cases}
0, & x<0 \\
-1, & x\ge 0
\end{cases}
$$

特征线相交，我们使用Rankie-Hugoniot跳变条件可知

$$
s^{'}(t) [\rho] = [f^{'}(\rho)]
$$

#### 1.1.2 绿灯通行

## 2 数值求解

### 2.1 交通堵塞

考虑一下问题

$$
\begin{cases}
\partial_t \rho(x,t) + (1-2\rho(x,t)) \partial_x \rho(x,t) = 0, & (x,t) \in \Omega_T = (-1,1) \times (0,1) \\
\rho_0(x) =
\begin{cases}
0.5, & x < 0 \\
1, & x \geq 0
\end{cases}, & x \in (-1,1) \\
\rho(-1,t) = 0.5, \quad \rho(1,t) = 1, & t \in [0,1]
\end{cases}
$$
